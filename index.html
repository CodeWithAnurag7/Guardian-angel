<!DOCTYPE html>
<html>
<head>
    <title>Tourist Safety App</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body { font-family: Arial; margin: 0; padding: 0; }
        #alert { padding: 10px; font-size: 18px; margin: 10px; }
        #alert.safe { color: green; }
        #alert.danger { color: red; }
        #map { height: 600px; width: 100%; }
    </style>
</head>
<body>

<h1>Tourist Safety App</h1>
<div id="alert" class="safe">&#9989; You are in a safe area</div>
<div id="map"></div>

<script>
    // Initialize map
    var map = L.map('map').setView([28.6110, 77.2100], 15);

    // Add tile layer
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19
    }).addTo(map);

    // Danger zones
    var dangerZones = [
        {lat:28.6129, lng:77.2295, radius:400, reason:"Riot reported"},
        {lat:28.6200, lng:77.2200, radius:300, reason:"Flooded area"}
    ];

    dangerZones.forEach(function(zone){
        L.circle([zone.lat, zone.lng], {
            color: 'red',
            fillColor: 'red',
            fillOpacity: 0.4,
            radius: zone.radius
        }).addTo(map).bindPopup("Danger: " + zone.reason);
    });

    // Tourist path
    var path = [
        [28.6110,77.2100],
        [28.6120,77.2120],
        [28.6130,77.2140],
        [28.6140,77.2160],
        [28.6150,77.2180],
        [28.6165,77.2190],
        [28.6180,77.2195],
        [28.6195,77.2200]
    ];

    var SAFETY_RADIUS = 500;

    // Add tourist bubble
    var touristCircle = L.circle(path[0], {
        color: 'green',
        fillColor: 'green',
        fillOpacity: 0.3,
        radius: SAFETY_RADIUS
    }).addTo(map);

    var alertBox = document.getElementById("alert");

    // Animate movement
    var index = 0;
    function moveTourist(){
        if(index >= path.length) return;
        touristCircle.setLatLng(path[index]);

        // Check for danger
        var dangerMessages = [];
        dangerZones.forEach(function(zone){
            var distance = map.distance(path[index], [zone.lat, zone.lng]);
            if(distance <= SAFETY_RADIUS + zone.radius){
                dangerMessages.push(zone.reason);
            }
        });

        if(dangerMessages.length > 0){
            touristCircle.setStyle({color:'red', fillColor:'red'});
            alertBox.className = "danger";
            alertBox.innerHTML = "&#9888; WARNING: You are entering a danger zone! Reason: " + dangerMessages.join(", ");
        } else {
            touristCircle.setStyle({color:'green', fillColor:'green'});
            alertBox.className = "safe";
            alertBox.innerHTML = "&#9989; You are in a safe area";
        }

        index++;
        setTimeout(moveTourist, 1500); // slower animation
    }

    moveTourist();
</script>

<script src="blockchain.js"></script>

</body>
</html>
